<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¦ã‚©ãƒ¬ãƒƒãƒˆèªè¨¼</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
</head>
<body>
    <h2>Metamaskã§ã‚¦ã‚©ãƒ¬ãƒƒãƒˆèªè¨¼</h2>
    <button id="signButton">ç½²åã™ã‚‹</button>
    <p id="result"></p>

    <script>
        window.onload = function () {
            document.getElementById("signButton").addEventListener("click", signMessage);
        };

        async function signMessage() {
            console.log("ğŸ“Œ signMessage() ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ");

            if (!window.ethereum) {
                alert("Metamaskã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼");
                console.log("âŒ MetamaskãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
                return;
            }

            try {
                // Metamaskæ¥ç¶š
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                console.log("âœ… Metamaskã®æ¥ç¶šã«æˆåŠŸ");

                const signer = provider.getSigner();
                const address = await signer.getAddress();
                console.log("âœ… ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹:", address);

                // output.txt ã‚’èª­ã¿è¾¼ã‚“ã§ãƒã‚§ãƒƒã‚¯
                const isInList = await checkWalletInList(address);
                if (isInList) {
                    document.getElementById("result").textContent = "âœ… è©²å½“ï¼";
                    console.log("âœ… ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã™");
                } else {
                    document.getElementById("result").textContent = "âŒ è©²å½“ãªã—";
                    console.log("âŒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“");
                }
            } catch (error) {
                console.error("âŒ èªè¨¼ã‚¨ãƒ©ãƒ¼:", error);
                alert("èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
            }
        }

       // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒªã‚¹ãƒˆã‚’ç›´æ¥åŸ‹ã‚è¾¼ã‚€
const walletList = [
    "0x0000...dEaD", "0x255E...2D24", "0x571F...250d", "0xD14c...3c67",
    "0xc717...971C", "0x29C7...e086", "0xff11...11Cf", "0xEd9C...DCDE",
    "0xd287...2D84", "0xCeD4...1902", "0x9694...C7B4", "0x961B...018C",
    "0x909C...2cfD", "0x7489...BB9D", "0x6DE8...7960", "0x35Ce...6762",
    "0x124E...3FA7", "0xff70...917e", "0xFE29...6eD7", "0xb716...8E51"
    // å¿…è¦ã«å¿œã˜ã¦ç¶šã‘ã‚‹...
];

async function checkWalletInList(userAddress) {
    const formattedUserAddress = userAddress.slice(0, 6) + "..." + userAddress.slice(-4);
    console.log("ğŸ” ç¢ºèªä¸­ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ:", formattedUserAddress);
    console.log("ğŸ“œ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒªã‚¹ãƒˆ:", walletList);
    return walletList.includes(formattedUserAddress);
}


    </script>
</body>
</html>
